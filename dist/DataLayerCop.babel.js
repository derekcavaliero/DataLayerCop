var _class;function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,_toPropertyKey(r.key),r)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"===_typeof(t)?t:String(t)}function _toPrimitive(e,t){if("object"!==_typeof(e)||null===e)return e;var a=e[Symbol.toPrimitive];if(void 0!==a){var r=a.call(e,t||"default");if("object"!==_typeof(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}function _classPrivateMethodInitSpec(e,t){_checkPrivateRedeclaration(e,t),t.add(e)}function _classPrivateFieldInitSpec(e,t,a){_checkPrivateRedeclaration(e,t),t.set(e,a)}function _checkPrivateRedeclaration(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _classPrivateMethodGet(e,t,a){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return a}function _classPrivateFieldGet(e,t){return _classApplyDescriptorGet(e,_classExtractFieldDescriptor(e,t,"get"))}function _classApplyDescriptorGet(e,t){return t.get?t.get.call(e):t.value}function _classPrivateFieldSet(e,t,a){return _classApplyDescriptorSet(e,_classExtractFieldDescriptor(e,t,"set"),a),a}function _classExtractFieldDescriptor(e,t,a){if(!t.has(e))throw new TypeError("attempted to "+a+" private field on non-instance");return t.get(e)}function _classApplyDescriptorSet(e,t,a){if(t.set)t.set.call(e,a);else{if(!t.writable)throw new TypeError("attempted to set read only private field");t.value=a}}var _config=new WeakMap,_setDataLayer=new WeakSet,_getDataLayer=new WeakSet,_modifyPushMethod=new WeakSet,_registerRules=new WeakSet,_getPredefinedRule=new WeakSet,_enforceRule=new WeakSet,_processRules=new WeakSet,_reportToConsole=new WeakSet,_reportToDataLayer=new WeakSet,_reportToUrl=new WeakSet,_redactPayload=new WeakSet,_isArgumentsObject=new WeakSet,_isValidUrl=new WeakSet,_isPreferredCase=new WeakSet,_callStatic=new WeakSet,DataLayerCop=function(){function e(){var t,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};_classCallCheck(this,e),_classPrivateMethodInitSpec(this,_callStatic),_classPrivateMethodInitSpec(this,_isPreferredCase),_classPrivateMethodInitSpec(this,_isValidUrl),_classPrivateMethodInitSpec(this,_isArgumentsObject),_classPrivateMethodInitSpec(this,_redactPayload),_classPrivateMethodInitSpec(this,_reportToUrl),_classPrivateMethodInitSpec(this,_reportToDataLayer),_classPrivateMethodInitSpec(this,_reportToConsole),_classPrivateMethodInitSpec(this,_processRules),_classPrivateMethodInitSpec(this,_enforceRule),_classPrivateMethodInitSpec(this,_getPredefinedRule),_classPrivateMethodInitSpec(this,_registerRules),_classPrivateMethodInitSpec(this,_modifyPushMethod),_classPrivateMethodInitSpec(this,_getDataLayer),_classPrivateMethodInitSpec(this,_setDataLayer),_classPrivateFieldInitSpec(this,_config,{writable:!0,value:{}});_classPrivateFieldSet(this,_config,Object.assign(_classPrivateFieldGet(this,_config),{dataLayer:"dataLayer",preferredCase:"snake",reportToUrl:!1,reportToDataLayer:!1,reportOnly:[],rules:[]},a)),_classPrivateMethodGet(this,_setDataLayer,_setDataLayer2).call(this),_classPrivateMethodGet(this,_registerRules,_registerRules2).call(this),Array.isArray(_classPrivateFieldGet(this,_config).rules)&&null!==(t=_classPrivateFieldGet(this,_config).rules)&&void 0!==t&&t.length?(_classPrivateMethodGet(this,_modifyPushMethod,_modifyPushMethod2).call(this),_classPrivateMethodGet(this,_getDataLayer,_getDataLayer2).call(this).push({event:"datalayercop.loaded",rules:_classPrivateFieldGet(this,_config).rules})):_classPrivateMethodGet(this,_reportToConsole,_reportToConsole2).call(this,"warn","No rules defined.")}return _createClass(e,null,[{key:"getCommonPattern",value:function(e){switch(e){case"snake":return/^[a-z0-9_]+$/;case"camel":return/^[a-z0-9]+([A-Z][a-z0-9]+)*$/;case"pascal":return/^[A-Z][a-z0-9]+([A-Z][a-z0-9]+)*$/;case"namespaced":return/^([a-zA-Z0-9_]+\.)/;default:return e}}},{key:"isObjectLiteral",value:function(e){var t=e;return"object"===_typeof(e)&&null!==e&&function(){for(;null!==Object.getPrototypeOf(t=Object.getPrototypeOf(t)););return Object.getPrototypeOf(e)===t}()}},{key:"isSnakeCase",value:function(t){return e.getCommonPattern("snake").test(t)}},{key:"isCamelCase",value:function(t){return e.getCommonPattern("camel").test(t)}},{key:"isPascalCase",value:function(t){return e.getCommonPattern("pascal").test(t)}},{key:"isNamespaced",value:function(t){return e.getCommonPattern("namespaced").test(t)}}]),e}();function _setDataLayer2(){window[_classPrivateFieldGet(this,_config).dataLayer]=window[_classPrivateFieldGet(this,_config).dataLayer]||[]}function _getDataLayer2(){return window[_classPrivateFieldGet(this,_config).dataLayer]}function _modifyPushMethod2(){var e=this,t=_classPrivateMethodGet(this,_getDataLayer,_getDataLayer2).call(this).push;_classPrivateMethodGet(this,_getDataLayer,_getDataLayer2).call(this).push=function(){var a;if(_classPrivateMethodGet(e,_isArgumentsObject,_isArgumentsObject2).call(e,arguments[0])){var r=arguments[0];"event"==r[0]&&(a=_classPrivateMethodGet(e,_processRules,_processRules2).call(e,r,"gtag"))}else if(_classPrivateMethodGet(e,_callStatic,_callStatic2).call(e,"isObjectLiteral",arguments[0])){var s;null!==(s=a=arguments[0])&&void 0!==s&&null!==(s=s.event)&&void 0!==s&&s.startsWith("gtm.")||(a=_classPrivateMethodGet(e,_processRules,_processRules2).call(e,a,"gtm"))}if(a)return t(a)}}function _registerRules2(){var e=this;_classPrivateFieldGet(this,_config).rules=_classPrivateFieldGet(this,_config).rules.map((function(t){return t.predefined&&delete(t=Object.assign({},_classPrivateMethodGet(e,_getPredefinedRule,_getPredefinedRule2).call(e,t.predefined),t)).predefined,t}))}function _getPredefinedRule2(e){var t=this;return{event_property_exists:{name:"Expect payload to include an `event` property.",assert:function(e){return e.hasOwnProperty("event")&&e.event.length},dropOnFail:!1,type:"gtm"},event_is_namespaced:{name:"Expect `event` property value to be prefixed with a namespace.",assert:function(e){return _classPrivateMethodGet(t,_callStatic,_callStatic2).call(t,"isNamespaced",e.event)},dropOnFail:!1,type:"gtm"},payload_properties_are_preferred_case:{name:"Expect all payload properties to match preferred case (".concat(_classPrivateFieldGet(this,_config).preferredCase,")."),assert:function(e){for(var a=Object.keys(e),r=0;r<a.length;r++)if(!_classPrivateMethodGet(t,_isPreferredCase,_isPreferredCase2).call(t,a[r]))return!1;return!0},dropOnFail:!1},event_is_preferred_case_after_namespace:{name:"Expect `event` property value to match preferred case (".concat(_classPrivateFieldGet(this,_config).preferredCase,") after namespace."),assert:function(e){if(!_classPrivateMethodGet(t,_callStatic,_callStatic2).call(t,"isNamespaced",e.event))return!0;var a=e.event.split(".")[1];return _classPrivateMethodGet(t,_isPreferredCase,_isPreferredCase2).call(t,a)},dropOnFail:!1,type:"gtm"}}[e]||{}}function _enforceRule2(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,a=arguments.length>2?arguments[2]:void 0,r={rule:e,payload:t,payloadType:a};return"function"!=typeof e.assert?(_classPrivateMethodGet(this,_reportToConsole,_reportToConsole2).call(this,"warn","Rule object is missing assert method - skipping...",e),r.passed=!0,r):(r.passed=e.assert(t,a),r.passed||_classPrivateMethodGet(this,_reportToConsole,_reportToConsole2).call(this,"warn","".concat(a," payload failed rule: ").concat(null==e?void 0:e.name),r),r)}function _processRules2(e,t){for(var a=0;a<_classPrivateFieldGet(this,_config).rules.length;a++){var r=_classPrivateFieldGet(this,_config).rules[a];if(null==r||!r.type||r.type===t){var s=_classPrivateMethodGet(this,_enforceRule,_enforceRule2).call(this,r,e,t);if(!s.passed&&(_classPrivateFieldGet(this,_config).reportOnly.includes(null==r?void 0:r.severity)&&(_classPrivateMethodGet(this,_reportToDataLayer,_reportToDataLayer2).call(this,s),_classPrivateFieldGet(this,_config).reportToUrl&&_classPrivateMethodGet(this,_reportToUrl,_reportToUrl2).call(this,s)),r.dropOnFail))return!1}}return e}function _reportToConsole2(e,t,a){console[e]("ðŸš¨ ".concat(_classPrivateFieldGet(this,_config).dataLayer," Cop - ").concat(t),a)}function _reportToDataLayer2(e){var t;!1!==_classPrivateFieldGet(this,_config).reportToDataLayer&&_classPrivateMethodGet(this,_getDataLayer,_getDataLayer2).call(this).push({event:"gtm.pageError","gtm.errorMessage":null===(t=e.rule)||void 0===t?void 0:t.name,datalayercop:e})}function _reportToUrl2(e){if(_classPrivateMethodGet(this,_isValidUrl,_isValidUrl2).call(this,_classPrivateFieldGet(this,_config).reportToUrl)){var t={hostname:location.hostname,url:location.href,user_agent:navigator.userAgent};Object.assign(t,e),t.payload=_classPrivateMethodGet(this,_redactPayload,_redactPayload2).call(this,t.payload),navigator.sendBeacon(_classPrivateFieldGet(this,_config).reportToUrl,JSON.stringify(t))}else _classPrivateMethodGet(this,_reportToConsole,_reportToConsole2).call(this,"warn","Attempted to report to URL - but an invalid URL was provided (".concat(_classPrivateFieldGet(this,_config).reportToUrl,")."),payload)}function _redactPayload2(e,t){for(var a=JSON.parse(JSON.stringify(e)),r=Object.keys(a),s=0;s<r.length;s++){var i=r[s],o=a[i];if("object"!==_typeof(o))new RegExp("name|email|tele|phone|address|street|country|city|state|province|region|zip|postal|country|birth|dob|born|gender|sex|race|ethnicity|height|weight|password","i").test(i)&&(a[i]="(redacted)");else a[i]=_classPrivateMethodGet(this,_redactPayload,_redactPayload2).call(this,o)}return a}function _isArgumentsObject2(e){return"[object Arguments]"===Object.prototype.toString.call(e)}function _isValidUrl2(e){try{var t=new URL(e)}catch(e){return!1}return"https:"===t.protocol}function _isPreferredCase2(e){return _class.getCommonPattern(_classPrivateFieldGet(this,_config).preferredCase).test(e)}function _callStatic2(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),r=1;r<t;r++)a[r-1]=arguments[r];return _class[e].apply(this,a)}_class=DataLayerCop;
